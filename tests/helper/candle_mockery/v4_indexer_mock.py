from datetime import datetime, timedelta, timezone
from typing import Any, Dict, List, Optional

from sir_utilities.date_time import datetime_to_string, string_to_datetime

from dydx_v4_client.indexer.rest.indexer_client import IndexerClient, MarketsClient  # type: ignore
from dydx_v4_client.network import TESTNET  # type: ignore

from locast.candle.dydx.dydx_resolution import DydxResolution


class V4MarketsClientMock(MarketsClient):
    def __init__(self) -> None:
        self._mock_candle_base: Dict[str, Any] = {
            "startedAt": "2024-05-06T17:24:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.688",
            "high": "14.688",
            "open": "14.688",
            "close": "14.688",
            "baseTokenVolume": "0",
            "usdVolume": "0",
            "trades": 0,
            "startingOpenInterest": "11132",
        }

        self._temp_candle_base = self._replace_date(
            self._mock_candle_base,
            datetime.now(timezone.utc),
        )

    # This needs to return 100 candles ranging from current date backwards, such that each call to this func, returns the next 100 candles.
    # For the sake of simplicity we simply hold one candle, prepare 100 candles from it by copying it and changing the date.
    # This algorithm can be extended later on, if we ever need to have variability in candle data apart from dates.

    async def get_perpetual_market_candles(
        self,
        market: str,
        resolution: str,
        from_iso: Optional[str] = None,
        to_iso: Optional[str] = None,
        limit: Optional[int] = None,
    ) -> Dict[str, Any]:
        """
        Generates mocked price candles for a given market, resolution, and time range.

        Args:
            market (str): The market for which to retrieve candles.
            resolution (str): The resolution of the candles.
            from_iso (Optional[str], optional): The start date of the candle range in ISO format. Defaults to None.
            to_iso (Optional[str], optional): The end date of the candle range in ISO format. Defaults to None.
            limit (Optional[int], optional): The maximum number of candles to retrieve. Defaults to None.

        Returns:
            Dict[str, Any]: A dictionary containing a list of candle dictionaries.

        Raises:
            AssertionError: If to_iso or from_iso is not provided when mocking candles.

        Note:
            1) Before the first iteration we always add the first candle to the (then empty) batch in order to
            simplify the index based algorithm and prevent duplicates (at the end of one batch and the beginning of the next).
            While doing so we also modify certain attributes of that first batch candle, to correspond to the input resolution
            and date range.
            2) Specifically we subtract one resolution from the date, because the very first candle (which is the most
            recent one chronologically aka the newest one) will only reach to the to_iso date from its startedAt date which
            is one resolution earlier.
            3) Because of this strategy (adding the first candle by hand) we need to subtract 1 from the range input in our
            for loop, since we want every batch to be either 100 candles wide or less, if the provided range entails less.

        """
        assert to_iso, "to_iso must be provided when mocking candles."
        assert from_iso, "from_iso must be provided when mocking candles."

        self._mock_candle_base = self._replace_date(
            self._temp_candle_base,
            self._subtract_resolution(to_iso, resolution),
        )

        self._mock_candle_base["resolution"] = resolution
        candle_dicts_batch: List[Dict[str, Any]] = [self._temp_candle_base]

        amount = min(self._amount_of_candles(from_iso, to_iso, resolution), 100)
        for i in range(amount - 1):
            new_date = self._subtract_resolution(
                candle_dicts_batch[i]["startedAt"],
                candle_dicts_batch[i]["resolution"],
            )
            candle_dict = self._replace_date(candle_dicts_batch[i].copy(), new_date)
            candle_dicts_batch.append(candle_dict)

        return {"candles": candle_dicts_batch}

    def _amount_of_candles(
        self,
        from_iso: str,
        to_iso: str,
        resolution: str,
    ) -> int:
        range_seconds = (
            string_to_datetime(to_iso) - string_to_datetime(from_iso)
        ).total_seconds()
        return int(range_seconds / DydxResolution.notation_to_seconds(resolution))

    def _replace_date(
        self,
        candle_dict: Dict[str, Any],
        date: datetime,
    ) -> Dict[str, Any]:
        date_rounded = date.replace(microsecond=0, second=0)
        candle_dict["startedAt"] = datetime_to_string(date_rounded)
        return candle_dict

    def _subtract_resolution(self, date_str: str, resolution: str) -> datetime:
        date = string_to_datetime(date_str)
        res_sec = DydxResolution.notation_to_seconds(resolution)
        return date - timedelta(seconds=res_sec)


class V4IndexerClientMock(IndexerClient):
    def __init__(self, host: str = TESTNET.rest_indexer) -> None:
        super().__init__(host=host)
        self._markets = V4MarketsClientMock()

    @property
    def markets(self) -> MarketsClient:
        return self._markets


response = {
    "candles": [
        {
            "startedAt": "2024-05-06T17:24:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.688",
            "high": "14.688",
            "open": "14.688",
            "close": "14.688",
            "baseTokenVolume": "0",
            "usdVolume": "0",
            "trades": 0,
            "startingOpenInterest": "11132",
        },
        {
            "startedAt": "2024-05-06T17:23:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.688",
            "high": "14.725",
            "open": "14.725",
            "close": "14.688",
            "baseTokenVolume": "8",
            "usdVolume": "117.652",
            "trades": 2,
            "startingOpenInterest": "11128",
        },
        {
            "startedAt": "2024-05-06T17:22:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.702",
            "high": "14.702",
            "open": "14.702",
            "close": "14.702",
            "baseTokenVolume": "4",
            "usdVolume": "58.808",
            "trades": 1,
            "startingOpenInterest": "11128",
        },
        {
            "startedAt": "2024-05-06T17:21:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.71",
            "high": "14.723",
            "open": "14.723",
            "close": "14.71",
            "baseTokenVolume": "8",
            "usdVolume": "117.732",
            "trades": 2,
            "startingOpenInterest": "11132",
        },
        {
            "startedAt": "2024-05-06T17:20:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.73",
            "high": "14.757",
            "open": "14.73",
            "close": "14.757",
            "baseTokenVolume": "12",
            "usdVolume": "176.916",
            "trades": 3,
            "startingOpenInterest": "11142",
        },
        {
            "startedAt": "2024-05-06T17:19:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.735",
            "high": "14.752",
            "open": "14.752",
            "close": "14.735",
            "baseTokenVolume": "8",
            "usdVolume": "117.948",
            "trades": 2,
            "startingOpenInterest": "11138",
        },
        {
            "startedAt": "2024-05-06T17:18:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.738",
            "high": "14.741",
            "open": "14.739",
            "close": "14.738",
            "baseTokenVolume": "12",
            "usdVolume": "176.872",
            "trades": 3,
            "startingOpenInterest": "11138",
        },
        {
            "startedAt": "2024-05-06T17:17:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.74",
            "high": "14.758",
            "open": "14.756",
            "close": "14.74",
            "baseTokenVolume": "12",
            "usdVolume": "177.016",
            "trades": 3,
            "startingOpenInterest": "11144",
        },
        {
            "startedAt": "2024-05-06T17:16:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.757",
            "high": "14.757",
            "open": "14.757",
            "close": "14.757",
            "baseTokenVolume": "4",
            "usdVolume": "59.028",
            "trades": 1,
            "startingOpenInterest": "11148",
        },
        {
            "startedAt": "2024-05-06T17:15:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.745",
            "high": "14.758",
            "open": "14.758",
            "close": "14.745",
            "baseTokenVolume": "16",
            "usdVolume": "236.004",
            "trades": 4,
            "startingOpenInterest": "11156",
        },
        {
            "startedAt": "2024-05-06T17:14:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.733",
            "high": "14.75",
            "open": "14.75",
            "close": "14.733",
            "baseTokenVolume": "12",
            "usdVolume": "176.896",
            "trades": 3,
            "startingOpenInterest": "11164",
        },
        {
            "startedAt": "2024-05-06T17:13:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.764",
            "high": "14.764",
            "open": "14.764",
            "close": "14.764",
            "baseTokenVolume": "4",
            "usdVolume": "59.056",
            "trades": 1,
            "startingOpenInterest": "11168",
        },
        {
            "startedAt": "2024-05-06T17:12:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.746",
            "high": "14.746",
            "open": "14.746",
            "close": "14.746",
            "baseTokenVolume": "4",
            "usdVolume": "58.984",
            "trades": 1,
            "startingOpenInterest": "11164",
        },
        {
            "startedAt": "2024-05-06T17:11:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.76",
            "high": "14.76",
            "open": "14.76",
            "close": "14.76",
            "baseTokenVolume": "4",
            "usdVolume": "59.04",
            "trades": 1,
            "startingOpenInterest": "11168",
        },
        {
            "startedAt": "2024-05-06T17:10:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.702",
            "high": "14.714",
            "open": "14.714",
            "close": "14.702",
            "baseTokenVolume": "12",
            "usdVolume": "176.488",
            "trades": 3,
            "startingOpenInterest": "11156",
        },
        {
            "startedAt": "2024-05-06T17:09:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.692",
            "high": "14.72",
            "open": "14.715",
            "close": "14.72",
            "baseTokenVolume": "20",
            "usdVolume": "294.176",
            "trades": 5,
            "startingOpenInterest": "11164",
        },
        {
            "startedAt": "2024-05-06T17:08:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.702",
            "high": "14.713",
            "open": "14.702",
            "close": "14.713",
            "baseTokenVolume": "12",
            "usdVolume": "176.48",
            "trades": 3,
            "startingOpenInterest": "11160",
        },
        {
            "startedAt": "2024-05-06T17:07:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.71",
            "high": "14.71",
            "open": "14.71",
            "close": "14.71",
            "baseTokenVolume": "4",
            "usdVolume": "58.84",
            "trades": 1,
            "startingOpenInterest": "11156",
        },
        {
            "startedAt": "2024-05-06T17:06:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.703",
            "high": "14.721",
            "open": "14.721",
            "close": "14.703",
            "baseTokenVolume": "8",
            "usdVolume": "117.696",
            "trades": 2,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T17:05:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.656",
            "high": "14.656",
            "open": "14.656",
            "close": "14.656",
            "baseTokenVolume": "4",
            "usdVolume": "58.624",
            "trades": 1,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T17:04:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.654",
            "high": "14.678",
            "open": "14.667",
            "close": "14.678",
            "baseTokenVolume": "20",
            "usdVolume": "293.304",
            "trades": 5,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T17:03:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.698",
            "high": "14.698",
            "open": "14.698",
            "close": "14.698",
            "baseTokenVolume": "4",
            "usdVolume": "58.792",
            "trades": 1,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T17:02:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.641",
            "high": "14.689",
            "open": "14.641",
            "close": "14.689",
            "baseTokenVolume": "16",
            "usdVolume": "234.572",
            "trades": 4,
            "startingOpenInterest": "11148",
        },
        {
            "startedAt": "2024-05-06T17:01:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.605",
            "high": "14.605",
            "open": "14.605",
            "close": "14.605",
            "baseTokenVolume": "0",
            "usdVolume": "0",
            "trades": 0,
            "startingOpenInterest": "11148",
        },
        {
            "startedAt": "2024-05-06T17:00:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.594",
            "high": "14.605",
            "open": "14.594",
            "close": "14.605",
            "baseTokenVolume": "8",
            "usdVolume": "116.796",
            "trades": 2,
            "startingOpenInterest": "11148",
        },
        {
            "startedAt": "2024-05-06T16:59:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.61",
            "high": "14.614",
            "open": "14.61",
            "close": "14.614",
            "baseTokenVolume": "8",
            "usdVolume": "116.896",
            "trades": 2,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T16:58:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.624",
            "high": "14.665",
            "open": "14.663",
            "close": "14.627",
            "baseTokenVolume": "24",
            "usdVolume": "351.436",
            "trades": 6,
            "startingOpenInterest": "11160",
        },
        {
            "startedAt": "2024-05-06T16:57:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.672",
            "high": "14.688",
            "open": "14.672",
            "close": "14.688",
            "baseTokenVolume": "16",
            "usdVolume": "234.832",
            "trades": 4,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T16:56:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.65",
            "high": "14.65",
            "open": "14.65",
            "close": "14.65",
            "baseTokenVolume": "0",
            "usdVolume": "0",
            "trades": 0,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T16:55:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.65",
            "high": "14.654",
            "open": "14.654",
            "close": "14.65",
            "baseTokenVolume": "8",
            "usdVolume": "117.216",
            "trades": 2,
            "startingOpenInterest": "11152",
        },
        {
            "startedAt": "2024-05-06T16:54:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.654",
            "high": "14.694",
            "open": "14.68",
            "close": "14.665",
            "baseTokenVolume": "28",
            "usdVolume": "410.816",
            "trades": 7,
            "startingOpenInterest": "11156",
        },
        {
            "startedAt": "2024-05-06T16:53:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.671",
            "high": "14.686",
            "open": "14.686",
            "close": "14.671",
            "baseTokenVolume": "8",
            "usdVolume": "117.428",
            "trades": 2,
            "startingOpenInterest": "11156",
        },
        {
            "startedAt": "2024-05-06T16:52:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.681",
            "high": "14.694",
            "open": "14.681",
            "close": "14.694",
            "baseTokenVolume": "8",
            "usdVolume": "117.5",
            "trades": 2,
            "startingOpenInterest": "11164",
        },
        {
            "startedAt": "2024-05-06T16:51:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.677",
            "high": "14.688",
            "open": "14.677",
            "close": "14.688",
            "baseTokenVolume": "8",
            "usdVolume": "117.46",
            "trades": 2,
            "startingOpenInterest": "11168",
        },
        {
            "startedAt": "2024-05-06T16:50:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.659",
            "high": "14.698",
            "open": "14.698",
            "close": "14.659",
            "baseTokenVolume": "9",
            "usdVolume": "132.143",
            "trades": 3,
            "startingOpenInterest": "11168",
        },
        {
            "startedAt": "2024-05-06T16:49:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.656",
            "high": "14.671",
            "open": "14.665",
            "close": "14.671",
            "baseTokenVolume": "16",
            "usdVolume": "234.592",
            "trades": 4,
            "startingOpenInterest": "11158",
        },
        {
            "startedAt": "2024-05-06T16:48:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.662",
            "high": "14.67",
            "open": "14.662",
            "close": "14.67",
            "baseTokenVolume": "8",
            "usdVolume": "117.328",
            "trades": 2,
            "startingOpenInterest": "11158",
        },
        {
            "startedAt": "2024-05-06T16:47:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.618",
            "high": "14.656",
            "open": "14.656",
            "close": "14.618",
            "baseTokenVolume": "12",
            "usdVolume": "175.688",
            "trades": 3,
            "startingOpenInterest": "11163",
        },
        {
            "startedAt": "2024-05-06T16:46:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.621",
            "high": "14.667",
            "open": "14.667",
            "close": "14.621",
            "baseTokenVolume": "12",
            "usdVolume": "175.808",
            "trades": 3,
            "startingOpenInterest": "11159",
        },
        {
            "startedAt": "2024-05-06T16:45:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.637",
            "high": "14.684",
            "open": "14.655",
            "close": "14.666",
            "baseTokenVolume": "16",
            "usdVolume": "234.568",
            "trades": 4,
            "startingOpenInterest": "11167",
        },
        {
            "startedAt": "2024-05-06T16:44:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.656",
            "high": "14.677",
            "open": "14.676",
            "close": "14.656",
            "baseTokenVolume": "20",
            "usdVolume": "293.324",
            "trades": 5,
            "startingOpenInterest": "11175",
        },
        {
            "startedAt": "2024-05-06T16:43:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.69",
            "high": "14.69",
            "open": "14.69",
            "close": "14.69",
            "baseTokenVolume": "4",
            "usdVolume": "58.76",
            "trades": 1,
            "startingOpenInterest": "11171",
        },
        {
            "startedAt": "2024-05-06T16:42:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.672",
            "high": "14.694",
            "open": "14.694",
            "close": "14.672",
            "baseTokenVolume": "20",
            "usdVolume": "293.632",
            "trades": 5,
            "startingOpenInterest": "11175",
        },
        {
            "startedAt": "2024-05-06T16:41:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.658",
            "high": "14.693",
            "open": "14.658",
            "close": "14.666",
            "baseTokenVolume": "20",
            "usdVolume": "293.544",
            "trades": 5,
            "startingOpenInterest": "11175",
        },
        {
            "startedAt": "2024-05-06T16:40:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.68",
            "high": "14.681",
            "open": "14.68",
            "close": "14.681",
            "baseTokenVolume": "8",
            "usdVolume": "117.444",
            "trades": 2,
            "startingOpenInterest": "11179",
        },
        {
            "startedAt": "2024-05-06T16:39:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.694",
            "high": "14.723",
            "open": "14.715",
            "close": "14.694",
            "baseTokenVolume": "12",
            "usdVolume": "176.528",
            "trades": 3,
            "startingOpenInterest": "11183",
        },
        {
            "startedAt": "2024-05-06T16:38:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.698",
            "high": "14.722",
            "open": "14.713",
            "close": "14.722",
            "baseTokenVolume": "20",
            "usdVolume": "294.208",
            "trades": 5,
            "startingOpenInterest": "11187",
        },
        {
            "startedAt": "2024-05-06T16:37:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.704",
            "high": "14.704",
            "open": "14.704",
            "close": "14.704",
            "baseTokenVolume": "4",
            "usdVolume": "58.816",
            "trades": 1,
            "startingOpenInterest": "11187",
        },
        {
            "startedAt": "2024-05-06T16:36:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.699",
            "high": "14.716",
            "open": "14.71",
            "close": "14.699",
            "baseTokenVolume": "24",
            "usdVolume": "353.024",
            "trades": 6,
            "startingOpenInterest": "11195",
        },
        {
            "startedAt": "2024-05-06T16:35:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.719",
            "high": "14.732",
            "open": "14.732",
            "close": "14.719",
            "baseTokenVolume": "8",
            "usdVolume": "117.804",
            "trades": 2,
            "startingOpenInterest": "11199",
        },
        {
            "startedAt": "2024-05-06T16:34:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.71",
            "high": "14.71",
            "open": "14.71",
            "close": "14.71",
            "baseTokenVolume": "4",
            "usdVolume": "58.84",
            "trades": 1,
            "startingOpenInterest": "11199",
        },
        {
            "startedAt": "2024-05-06T16:33:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.7",
            "high": "14.714",
            "open": "14.7",
            "close": "14.714",
            "baseTokenVolume": "8",
            "usdVolume": "117.656",
            "trades": 2,
            "startingOpenInterest": "11195",
        },
        {
            "startedAt": "2024-05-06T16:32:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.699",
            "high": "14.73",
            "open": "14.708",
            "close": "14.699",
            "baseTokenVolume": "24",
            "usdVolume": "353.152",
            "trades": 6,
            "startingOpenInterest": "11206",
        },
        {
            "startedAt": "2024-05-06T16:31:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.679",
            "high": "14.741",
            "open": "14.74",
            "close": "14.679",
            "baseTokenVolume": "16",
            "usdVolume": "235.564",
            "trades": 4,
            "startingOpenInterest": "11207",
        },
        {
            "startedAt": "2024-05-06T16:30:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.747",
            "high": "14.771",
            "open": "14.771",
            "close": "14.747",
            "baseTokenVolume": "12",
            "usdVolume": "177.124",
            "trades": 3,
            "startingOpenInterest": "11210",
        },
        {
            "startedAt": "2024-05-06T16:29:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.764",
            "high": "14.78",
            "open": "14.764",
            "close": "14.78",
            "baseTokenVolume": "8",
            "usdVolume": "118.176",
            "trades": 2,
            "startingOpenInterest": "11210",
        },
        {
            "startedAt": "2024-05-06T16:28:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.744",
            "high": "14.765",
            "open": "14.75",
            "close": "14.751",
            "baseTokenVolume": "20",
            "usdVolume": "295.072",
            "trades": 5,
            "startingOpenInterest": "11202",
        },
        {
            "startedAt": "2024-05-06T16:27:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.765",
            "high": "14.765",
            "open": "14.765",
            "close": "14.765",
            "baseTokenVolume": "0",
            "usdVolume": "0",
            "trades": 0,
            "startingOpenInterest": "11202",
        },
        {
            "startedAt": "2024-05-06T16:26:00.000Z",
            "ticker": "LINK-USD",
            "resolution": "1MIN",
            "low": "14.738",
            "high": "14.765",
            "open": "14.738",
            "close": "14.765",
            "baseTokenVolume": "12",
            "usdVolume": "177.004",
            "trades": 3,
            "startingOpenInterest": "11194",
        },
        ...,
    ]
}
